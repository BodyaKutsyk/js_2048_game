parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KIzB":[function(require,module,exports) {
"use strict";function e(e){return o(e)||n(e)||r(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function n(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function o(e){if(Array.isArray(e))return a(e)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var s=function(){function t(e){i(this,t),this.HTML_CELLS=e,this.HTML_MATRIX=[],this.madeMove=!1,this.isGameStarted=!1,this.winStatus=!1,this.score=0}return c(t,[{key:"randomNumber",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"makeMatrix",value:function(e){var t=[],r=0;if(!e)for(var n=0;n<4;n++){t.push([]);for(var o=0;o<4;o++)t[n].push(0)}if(e)for(var a=0;a<e.length/4;a++){t.push([]);for(var i=0;i<e.length/4;i++)t[a].push(e[r]),r++}return t}},{key:"rotateMatrix",value:function(t){for(var r=t.map(function(t){return e(t)}),n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)r[n][o]=t[t.length-1-o][n];return r}},{key:"reverseRotate",value:function(t){for(var r=t.map(function(t){return e(t)}),n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)r[n][o]=t[o][t[n].length-1-n];return r}},{key:"randomCell",value:function(e){for(var t=[],r=0;r<e.length;r++){for(var n=[r],o=0;o<e[r].length;o++)0===e[r][o]&&n.push(o);n.length>1&&t.push(n)}var a=t[this.randomNumber(0,t.length)];if(a){var i=this.randomNumber(1,a.length),l=Math.random()<.9?2:4,c=a[0],s=a[i];return e[c][s]=l,[c,s]}}},{key:"canMoveVerticaly",value:function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length-1;r++)if(e[t][r]===e[t][r+1])return!0;return!1}},{key:"canMoveHorizontaly",value:function(e){for(var t=0;t<e.length-1;t++)for(var r=0;r<e[t].length;r++)if(e[t][r]===e[t+1][r])return!0;return!1}},{key:"hasEmptySpace",value:function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)if(0===e[t][r])return!0;return!1}},{key:"moveLeft",value:function(e,t,r,n){for(var o=this.moveList,a=e[t],i=0;i<a.length;i++)0!==a[i]&&function(){for(var e=i,l=i-1;l>=0;l--)if(0===a[l]&&(n||(a[l]=a[e],o[t][i]++,a[e]=0,r[i].after||(r[i].after=i,r[i].before=i),r[i].after--,r[i].before=i,e--),n)){var c=!0;if(a[l]=a[e],a[e]=0,r.forEach(function(r){r.after===e&&(o[t][r.before]++,c=!1)}),c)for(var s=i;s<a.length;s++)0===a[s]&&o[t][s]++}}();return a}},{key:"moveRight",value:function(e,t,r,n){for(var o=this.moveList,a=e[t],i=a.length-1;i>=0;i--)0!==a[i]&&function(){for(var e=i,l=i+1;l<a.length;l++)if(0===a[l]&&(n||(a[l]=a[e],o[t][i]++,a[e]=0,r[i].after||(r[i].after=i),r[i].after++,r[i].before=i,e++),n)){var c=!0;if(a[l]=a[e],a[e]=0,r.forEach(function(r){r.after===e&&(o[t][r.before]++,c=!1)}),c)for(var s=i;s>=0;s--)0===a[s]&&o[t][s]++}}();return a}},{key:"mergeLeft",value:function(e,t,r){for(var n=this,o=function(o){if(e[o]===e[o+1]&&0!==e[o]){e[o]+=e[o+1],n.score+=e[o];var i=!0;t.forEach(function(e){e.after===o+1&&(r[e.before]++,i=!1)}),i&&r[o+1]++,e[o+1]=0,o++}a=o},a=0;a<e.length;a++)o(a)}},{key:"mergeRight",value:function(e,t,r){for(var n=this,o=function(o){if(e[o]===e[o-1]&&0!==e[o]){e[o]+=e[o-1],n.score+=e[o];var i=!0;t.forEach(function(e){e.after===o-1&&(r[e.before]++,i=!1)}),i&&r[o-1]++,e[o-1]=0,o--}a=o},a=e.length-1;a>=0;a--)o(a)}},{key:"moveField",value:function(e,t,r){for(var n=this,o=this.rotateMatrix(e),a=0;a<e.length;a++){var i=e[a],l=[{},{},{},{}],c=0;switch(t){case"ArrowLeft":i=this.moveLeft(e,a,l,c),c=1,this.mergeLeft(i,l,r[a]),e[a]=i,e[a]=this.moveLeft(e,a,l,c);break;case"ArrowRight":i=this.moveRight(e,a,l,c),c=1,this.mergeRight(i,l,r[a]),e[a]=i,e[a]=this.moveRight(e,a,l,c);break;case"ArrowUp":i=this.moveRight(o,a,l,c),c=1,this.mergeRight(i,l,r[a]),e[a]=i,e[a]=this.moveRight(o,a,r,l,c);break;case"ArrowDown":i=this.moveLeft(o,a,l,c),c=1,this.mergeLeft(i,l,r[a]),e[a]=i,e[a]=this.moveLeft(o,a,l,c)}}"ArrowUp"!==t&&"ArrowDown"!==t||(e.forEach(function(t,r){e[r]=n.reverseRotate(o)[r]}),this.moveList=this.reverseRotate(r))}},{key:"visualize",value:function(e,t){var r=this,n=this.FIELD,o=this.HTML_MATRIX,a=this.moveList,i=t;t||(i=n);for(var l=0,c=!0,s=0;s<i.length;s++)for(var u=0;u<i[s].length;u++)i[s][u]===n[s][u]&&l++;l===n.length*n.length&&(c=!1);for(var f=0;f<i.length;f++)for(var m=0;m<i[f].length;m++){for(;o[f][m].firstChild;)o[f][m].removeChild(o[f][m].lastChild);var h=document.createElement("div");h.innerText="",h.classList="",i[f][m]>0&&(h.style.zIndex="2",h.innerText="".concat(i[f][m]),this.animateMovement(h,e,a[f][m]),h.classList="\n          field-cell\n          field-cell--inner-block\n          field-cell--".concat(i[f][m]),o[f][m].appendChild(h))}setTimeout(function(){for(var e=0;e<n.length;e++)for(var t=0;t<n[e].length;t++){for(var i=o[e][t];i.firstChild;)i.removeChild(i.lastChild);var l=document.createElement("div");l.innerText="",l.classList="",n[e][t]>0&&(l.style.zIndex="2",l.innerText="".concat(n[e][t]),l.classList="\n            field-cell\n            field-cell--inner-block\n            field-cell--".concat(n[e][t]),o[e][t].appendChild(l)),a[e][t]=0}if(r.hasEmptySpace(n)&&c&&r.madeMove){var s=document.createElement("div");setTimeout(function(){var e=r.randomCell(n);s.innerText="".concat(n[e[0]][e[1]]),s.classList="\n          field-cell\n          field-cell--inner-block\n          only-created\n          field-cell--".concat(n[e[0]][e[1]]),o[e[0]][e[1]].appendChild(s)},100)}},50)}},{key:"animateMovement",value:function(e,t,r){var n=85*r,o="",a=0;switch(t){case"ArrowUp":o="top";break;case"ArrowDown":o="bottom";break;case"ArrowLeft":o="left";break;case"ArrowRight":o="right"}e.style[o]="0px",e.style.zIndex="1",setTimeout(function(){(a+=n/r)>=n&&(a=n),e.style[o]=-n+"px"},10)}},{key:"checkWinState",value:function(){var e=this;return this.FIELD.forEach(function(t){t.forEach(function(t){2048===t&&(e.winStatus=!0)})}),this.winStatus}}]),t}(),u=document.querySelectorAll(".field-cell"),f=new s(u);function m(t){var r=f.FIELD.map(function(t){return e(t)});f.madeMove=!0,f.moveField(f.FIELD,t.key,f.moveList),f.visualize(t.key,r);for(var n=0;n<f.moveList.length;n++)for(var o=0;o<f.moveList.length;o++)f.moveList[n][o]=0;document.querySelector(".game-score").innerText="".concat(f.score),f.canMoveHorizontaly(f.FIELD)||f.canMoveVerticaly(f.FIELD)||f.hasEmptySpace(f.FIELD)?f.winStatus&&(document.querySelector(".game-field__game-win").style.display="flex",document.removeEventListener("keydown",m),setTimeout(function(){document.querySelector(".game-field__game-win").style.opacity="1",document.querySelector(".message-win").classList.remove("hidden")},10)):(document.querySelector(".game-field__game-over").style.display="flex",document.removeEventListener("keydown",m),setTimeout(function(){document.querySelector(".game-field__game-over").style.opacity="1",document.querySelector(".message-lose").classList.remove("hidden")},10))}f.FIELD=f.makeMatrix(),f.moveList=f.makeMatrix(),f.HTML_MATRIX=f.makeMatrix(u),document.body.querySelector(".button").addEventListener("click",function(){document.querySelector(".message-start").classList.add("hidden"),f.isGameStarted&&(f.FIELD.forEach(function(e,t){e.forEach(function(e,r){f.FIELD[t][r]=0})}),u.forEach(function(e){for(e.innerHTML="";e.firstChild;)e.removeChild(e.firstChild)}),document.body.querySelector("button").classList="button start",document.body.querySelector("button").innerHTML="Start",document.body.querySelector(".game-score").innerHTML="0",document.body.querySelector(".game-field__game-over").style.display="none",document.body.querySelector(".game-field__game-win").style.display="none",document.body.querySelector(".message-lose").classList.add("hidden"),document.body.querySelector(".message-win").classList.add("hidden"),document.body.querySelector(".message-start").classList.remove("hidden"),f.madeMove=!1,f.score=0),f.madeMove||(setTimeout(function(){f.randomCell(f.FIELD),f.randomCell(f.FIELD),f.visualize(f.FIELD,f.HTML_MATRIX,f.moveList)},50),document.querySelector(".button").classList="button restart",document.querySelector(".button").innerText="Restart",f.isGameStarted=!0),document.addEventListener("keydown",m)});
},{}]},{},["KIzB"], null)
//# sourceMappingURL=main.2f588d7d.js.map